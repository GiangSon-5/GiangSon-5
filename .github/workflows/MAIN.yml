# GitHub Action for generating a contribution graph with a snake eating your contributions.

name: Generate Snake

# Controls when the action will run. This action runs every 6 hours.

on:
  schedule:
      # every 6 hours
    - cron: "0 */6 * * *"

# This command allows us to run the Action automatically from the Actions tab.
  workflow_dispatch:

# The sequence of runs in this workflow:
jobs:
  # This workflow contains a single job called "build"
  build:
    # The type of runner that the job will run on
    runs-on: ubuntu-latest

    # Steps represent a sequence of tasks that will be executed as part of the job
    steps:
    - uses: actions/checkout@v3
      # In this step, this action saves a list of existing images,
      # the cache is created without them in the post run.
      # It also restores the cache if it exists.
    - name: Install Octopus CLI 🐙
      uses: OctopusDeploy/install-octopus-cli-action@v3
    - name: Extract branch name
      shell: bash
      id: extract_branch
      run: echo "branch=$(echo ${GITHUB_REF#refs/heads/})" >> $GITHUB_OUTPUT
    - name: Determine Octopus Deployment Channel
      shell: bash
      id: extract_channel
      run: |
          BRANCH="${{ steps.extract_branch.outputs.branch }}"
          CHANNEL="Features"
            if [[ "$BRANCH" == "main" ]] || [[ "$BRANCH" == "release/*" ]]; then
              CHANNEL="default"
            fi
            
            echo "channel=$(echo $CHANNEL)" >> $GITHUB_OUTPUT
